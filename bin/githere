#!/usr/bin/env zsh

usage() {
	echo "GITHERE"
	echo "\tMake aliases cleaner extending 'dohere' to also look for git's top level"
	echo "Dependencies: git, dohere"
	echo
	echo "\tUSAGE"
	echo "githere <command> [args...]"
	echo
	echo "\tIf no [arguments] are provided, the <command> is ran as '<command> \$toplevel' if in a repo, or as '<command> .'"
	echo "\tElse, the [arguments] get passed down and the <command> executed as usual"
}

declare cmd="$1"
shift || {
	echo "[githere] ERROR: No command passed"
	echo
	usage
	exit 1
}

declare toplevel
toplevel="$(git rev-parse --show-toplevel 2> /dev/null)"

dohere "$cmd" "${@:-$toplevel}"
